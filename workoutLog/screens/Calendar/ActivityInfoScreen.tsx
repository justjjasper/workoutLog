// implement algorithm that iterates through the state of activities